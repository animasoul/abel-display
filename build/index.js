(()=>{"use strict";var e,t={886:(e,t,a)=>{const l=window.wp.element,n=window.wp.blocks,r=window.wp.blockEditor,s=window.wp.data,i=window.wp.compose,o=window.wp.apiFetch;var d=a.n(o);const p=window.wp.i18n,c=(e,t)=>{if(e._embedded&&e._embedded["wp:featuredmedia"]&&e._embedded["wp:featuredmedia"][0].media_details&&e._embedded["wp:featuredmedia"][0].media_details.sizes){const a=e._embedded["wp:featuredmedia"][0].media_details.sizes;let l=a[t];if(!l&&a.full&&(l=a.full),l||(l=Object.values(a)[0]),l)return{url:l.source_url,width:l.width,height:l.height,alt:e._embedded["wp:featuredmedia"][0].alt_text}}const a=e.content?e.content.rendered:null,l=/<img[^>]+src="(http:\/\/[^">]+|https:\/\/[^">]+)"/g.exec(a);return l&&l[1]?{url:l[1],width:null,height:null,alt:null}:null};class u extends l.Component{constructor(){super(...arguments),this.handleCategoryChange=this.handleCategoryChange.bind(this),this.handleTagChange=this.handleTagChange.bind(this),this.handleDisplayStyleChange=this.handleDisplayStyleChange.bind(this)}handleCategoryChange=e=>{const t=e.map((e=>e.value));this.props.setAttributes({category:t})};handleTagChange=e=>{this.props.setAttributes({tags:e})};handleDisplayStyleChange=e=>{this.props.setAttributes({displayStyle:e})};componentDidMount(){const{categories:e,tags:t,setAttributes:a}=this.props;e||d()({path:"/wp/v2/categories?_fields=id,name"}).then((e=>e.json())).then((e=>{a({fetchedCategories:e})})),t||d()({path:"/wp/v2/tags?_fields=id,name"}).then((e=>e.json())).then((e=>{a({fetchedTags:e})}))}componentDidUpdate(e){const{posts:t,setAttributes:a}=this.props;t!==e.posts&&a({posts:t})}render(){const{posts:e,displayStyle:t,imageSize:a}=this.props.attributes;return e&&0!==e.length?(0,l.createElement)("div",{className:"abel-display-posts abel-display-style-"+t},e&&e.length>0?(0,l.createElement)("div",{className:"abel-wrapper","data-configuration":"1","data-roundness":"1"},e.map((e=>{const t=c(e,a);return t&&!t.alt&&(t.alt=e.title.rendered),(0,l.createElement)("div",{className:"shape",key:e.id},(0,l.createElement)("dialog",null,(0,l.createElement)("h2",null,e.title.rendered),(0,l.createElement)("img",{src:t.url,alt:t.alt,width:t.width,height:t.height,loading:"lazy"}),(0,l.createElement)("div",{dangerouslySetInnerHTML:{__html:e.content.rendered}}),(0,l.createElement)("button",{className:"close-button"},(0,p.__)("Close"))),(0,l.createElement)("p",null,e.title.rendered.length>1?e.title.rendered.substring(0,1):e.title.rendered))}))):(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:"abel-wrapper"},(0,p.__)("No posts found.")))):(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:"abel-wrapper"},(0,p.__)("No posts found. Please select some categories and tags.")))}}const m=(0,i.compose)([(0,s.withSelect)(((e,t)=>{const{getEntityRecords:a}=e("core"),{category:l,tag:n,numberposts:r}=t.attributes,s={per_page:r,status:"publish",_embed:!0,_fields:"id,link,title.rendered,content.rendered,_links,_embedded.wp:featuredmedia"};return l&&l.length&&(s.categories=l.join()),n&&n.length&&(s.tags=n.join()),{posts:a("postType","post",s)}})),(0,r.withColors)("backgroundColor","textColor")])(u),g=JSON.parse('{"u2":"create-block/abel-display"}'),h=window.wp.components,b=(0,s.withSelect)((e=>{const{getEntityRecords:t}=e("core");return{categories:t("taxonomy","category",{per_page:-1}),tags:t("taxonomy","post_tag",{per_page:-1})}}));(0,n.registerBlockType)(g.u2,{attributes:{category:{type:"array",default:[]},tag:{type:"array",default:[]},posts:{type:"array",default:[]},displayStyle:{type:"string",default:"default"},imageSize:{type:"string",default:"medium"},numberposts:{type:"number",default:5}},edit:b((e=>{const{categories:t,tags:a,setAttributes:n}=e;if(!t||!a)return"Loading...";const s=(()=>{const[e,t]=(0,l.useState)([]);return(0,l.useEffect)((()=>{window.wpImageSizes?t(Object.keys(window.wpImageSizes)):t([])}),[]),e})();return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(r.InspectorControls,null,(0,l.createElement)(h.PanelBody,{title:"Filter Posts"},(0,l.createElement)(h.SelectControl,{label:"Category",multiple:!0,value:e.attributes.category,options:t.map((e=>({label:e.name,value:e.id}))),onChange:e=>n({category:e})}),(0,l.createElement)(h.SelectControl,{label:"Tag",multiple:!0,value:e.attributes.tag,options:a.map((e=>({label:e.name,value:e.id}))),onChange:e=>n({tag:e})}),(0,l.createElement)(h.RangeControl,{label:"Number of posts to display",value:e.attributes.numberposts,onChange:e=>n({numberposts:e}),min:1,max:20}),(0,l.createElement)(h.SelectControl,{label:"Image Size",value:e.attributes.imageSize,options:s&&s.length>0?s.map((e=>({label:e,value:e}))):[],onChange:e=>n({imageSize:e})}),(0,l.createElement)(h.SelectControl,{label:"Display Style",value:e.attributes.displayStyle,options:[{label:"Default",value:"default"},{label:"List",value:"list"},{label:"Grid",value:"grid"}],onChange:e=>n({displayStyle:e})}))),(0,l.createElement)(m,e))})),save:e=>{let{attributes:t}=e;const{posts:a,displayStyle:n,imageSize:r}=t;return 0===a.length?null:(0,l.createElement)("div",{className:`abel-display-posts abel-display-style-${n}`},a&&a.length>0?(0,l.createElement)("div",{className:"abel-wrapper","data-configuration":"1","data-roundness":"1"},a.map((e=>{const t=c(e,r);return t&&!t.alt&&(t.alt=e.title.rendered),(0,l.createElement)("div",{className:"shape",key:e.id},(0,l.createElement)("dialog",null,(0,l.createElement)("h2",null,e.title.rendered),(0,l.createElement)("img",{src:t.url,alt:t.alt,width:t.width,height:t.height,loading:"lazy"}),(0,l.createElement)("div",{dangerouslySetInnerHTML:{__html:e.content.rendered}}),(0,l.createElement)("button",{className:"close-button"},(0,p.__)("Close"))),(0,l.createElement)("p",null,e.title.rendered.length>1?e.title.rendered.substring(0,1):e.title.rendered))}))):(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:"abel-wrapper"},(0,p.__)("No posts found."))))}})}},a={};function l(e){var n=a[e];if(void 0!==n)return n.exports;var r=a[e]={exports:{}};return t[e](r,r.exports,l),r.exports}l.m=t,e=[],l.O=(t,a,n,r)=>{if(!a){var s=1/0;for(p=0;p<e.length;p++){for(var[a,n,r]=e[p],i=!0,o=0;o<a.length;o++)(!1&r||s>=r)&&Object.keys(l.O).every((e=>l.O[e](a[o])))?a.splice(o--,1):(i=!1,r<s&&(s=r));if(i){e.splice(p--,1);var d=n();void 0!==d&&(t=d)}}return t}r=r||0;for(var p=e.length;p>0&&e[p-1][2]>r;p--)e[p]=e[p-1];e[p]=[a,n,r]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};l.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[s,i,o]=a,d=0;if(s.some((t=>0!==e[t]))){for(n in i)l.o(i,n)&&(l.m[n]=i[n]);if(o)var p=o(l)}for(t&&t(a);d<s.length;d++)r=s[d],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(p)},a=globalThis.webpackChunkabel_display=globalThis.webpackChunkabel_display||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var n=l.O(void 0,[431],(()=>l(886)));n=l.O(n)})();